<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
   <h4 id="heading"></h4>
   <table id="t" border="1"></table>
  </body>
  <script>
    function show() {
      var xhr = new XMLHttpRequest();
      xhr.open('GET', `./quoting.json`, true)
      xhr.responseType = 'json';
      xhr.send();
      xhr.onload = function() {
        console.log(xhr.response);
        var rows = [];
        var columns = [];
        for (var source in xhr.response) {
          if (columns.indexOf(source.split(' ')[0]) === -1) {
            columns.push(source.split(' ')[0]);
          }
          var dests = [];
          for (var dest in xhr.response[source]) {
            if (columns.indexOf(dest) === -1) {
              columns.push(dest);
            }
          }
          for (var i=0; i<columns.length; i++) {
            var text = xhr.response[source][columns[i]] || '?';
            if (text === 'error') {
              text = '<span style="background-color:red">error</span>';
            }
            dests.push(text);
          }
console.log(source, dests);
          rows.push(`<tr><td>${source}</td><td>${dests.join('</td><td>')}</td></tr>`);
        }
        var headers = '<tr><td>source:</td><td>' + columns.join('</td><td>') + '</td></tr>\n';
        document.getElementById('t').innerHTML = headers + rows.join('\n');
      };
    }
    show();
  </script>
</html>
